<?php
/**
 * The template for displaying archive pages
 *
 * @link https://developer.wordpress.org/themes/basics/template-hierarchy/
 *
 * @package Let\'s_Hear_It
 */

get_header();
?>

	<main id="primary" class="site-main">

		<?php if ( have_posts() ) : ?>

			<header class="page-header">
				<?php
				the_archive_title( '<h1 class="page-title">', '</h1>' );
				if ( get_post_type() == 'podcast' ) {
					$series = get_the_terms( get_the_ID(), 'series' )[0];
					$series_id = $series->term_id;
					$series_image = get_option( "ss_podcasting_data_image_{$series_id}", false );
					if ( $series_image ) {
						$series_image_attachment_id = attachment_url_to_postid( $series_image );
						$img_large = wp_get_attachment_image_src( $series_image_attachment_id, 'large' );
						$series_custom_fields = get_option( "taxonomy_term_$series_id" );
						echo '<div class="archive-meta">';
						echo '<img class="recent-episodes__image" src="' . $img_large[0] . '" width="' . $img_large[1] / 2 . '" height="' . $img_large[2] / 2 . '" alt="">';
						echo '<ul class="archive-meta__social">';
						if ( !empty( $series_custom_fields['twitter_url'] ) ) {
							echo '<li class="archive-meta__social-item">';
							echo '<a title="' . $series->name . ' on Twitter" href="' . $series_custom_fields['twitter_url'] . '" class="archive-meta__social-link">';
							echo '<svg role="img" height="36" viewBox="0 0 50 50" width="36" xmlns="http://www.w3.org/2000/svg"><path d="m25 50c13.8071194 0 25-11.1928806 25-25s-11.1928806-25-25-25-25 11.1928806-25 25 11.1928806 25 25 25zm0-3c12.1502651 0 22-9.8497349 22-22s-9.8497349-22-22-22-22 9.8497349-22 22 9.8497349 22 22 22zm-.3177446-26.4457025.0476886.8218036-.7948107-.100629c-2.8931108-.3857446-5.4206087-1.6939217-7.5665975-3.8909884l-1.0491501-1.0901476-.2702356.805032c-.5722637 1.7945507-.2066508 3.6897304.9855652 4.9643645.6358485.7044031.4927826.8050321-.6040561.3857446-.3815091-.1341721-.7153296-.2348011-.7471221-.1844865-.1112734.1174005.2702357 1.6436071.5722637 2.2473812.4133016.8385751 1.2558009 1.6603786 2.1777812 2.1467522l.7789145.3857445-.9219804.0167715c-.8901879 0-.9219803.0167715-.826603.368973.3179243 1.0901477 1.5737251 2.2473813 2.9725919 2.7505263l.9855651.3522016-.8583955.536688c-1.271697.7714891-2.7659411 1.2075482-4.2601851 1.2410912-.7153296.0167714-1.3034895.0838574-1.3034895.134172 0 .1677149 1.939338 1.1069191 3.0679692 1.4758921 3.3858934 1.0901476 7.4076354.6205455 10.4279159-1.2410911 2.1459888-1.3249487 4.2919777-3.9580744 5.2934391-6.5073427.5404712-1.3584916 1.0809425-3.8406738 1.0809425-5.0314505 0-.771489.0476886-.872118.9378765-1.7945506.5245751-.5366881 1.0173577-1.1236906 1.112735-1.2914057.1589621-.3186585.143066-.3186585-.6676409-.033543-1.3511782.5031451-1.5419328.4360591-.8742918-.3186585.4927826-.5366881 1.0809425-1.5094351 1.0809425-1.7945507 0-.0503145-.2384432.0335431-.5086788.1844865-.2861319.1677151-.9219804.4192876-1.3988668.5702311l-.8583955.2851155-.7789145-.5534596c-.4291978-.301887-1.0332538-.637317-1.3511781-.737946-.8107069-.234801-2.0506115-.201258-2.7818374.067086-1.9870266.7547176-3.2428275 2.7002118-3.0997615 4.8301925 0 0-.143066-2.1299807 0 0zm0 0" fill-rule="evenodd"/></svg>';
							echo '</a>';
							echo '</li>';
						}
						if ( !empty( $series_custom_fields['instagram_url'] ) ) {
							echo '<li class="archive-meta__social-item">';
							echo '<a title="' . $series->name . ' on Instagram" href="' . $series_custom_fields['instagram_url'] . '" class="archive-meta__social-link">';
							echo '<svg role="img" height="36" viewBox="0 0 50 50" width="36" xmlns="http://www.w3.org/2000/svg"><path d="m25 0c-13.8071194 0-25 11.1928806-25 25s11.1928806 25 25 25 25-11.1928806 25-25-11.1928806-25-25-25zm0 3c-12.1502651 0-22 9.8497349-22 22s9.8497349 22 22 22 22-9.8497349 22-22-9.8497349-22-22-22zm10.9513128 31.5096659c.0188467-.1021274.0326676-.2058966.0486872-.3083524v-18.402627c-.0153914-.1008139-.0285841-.2019561-.0474307-.3024415-.1925499-1.0307967-1.0057825-1.8307396-2.0043405-1.9735865-.0414626-.0055825-.0819829-.0151057-.1228172-.0226585h-17.6508232c-.1064835.0200314-.2135952.0351371-.3185082.0600942-.9746855.2321674-1.6958837 1.0527984-1.8347207 2.085237-.005654.0430183-.014135.0857082-.0213595.1287265v18.4528698c.0201031.1169046.0361227.2347944.0612516.3510422.2154799.9963164 1.0290267 1.7686751 1.9968018 1.8987151.0468025.0059109.0939191.015434.1407216.0233152h17.60245c.1143363-.0203598.2289867-.0371074.3420666-.0627213.8983566-.199329 1.6324334-.9828527 1.8080212-1.9276128zm-19.5709818-1.4107367c0 .4896202.4055169.9106082.873856.9106082 5.1627236.0003284 10.3251331.0003284 15.4878567 0 .4727366 0 .8760548-.4203312.8760548-.9135637.0003141-3.3997573 0-6.7991862 0-10.198615v-.0706026h-2.1001442c.2965205.9907339.3876126 1.9985437.2713916 3.0257282-.1168491 1.0275128-.4334727 1.9837664-.9492425 2.8667904-.5160839.8840091-1.1851397 1.616305-2.0043405 2.1991862-2.1233884 1.5118789-4.9189737 1.6448743-7.1720898.3228012-1.1389654-.6676042-2.0332386-1.5985722-2.6567484-2.7981582-.9300818-1.7900199-1.0786562-3.6687036-.5330459-5.6179897-.6966975.0006568-1.3905681.0006568-2.093862.0006568v.0620645c0 3.4036979-.0003141 6.8073958.0003142 10.2110937zm8.517426-3.4408053c2.4908979.0558253 4.505604-2.0248144 4.5580605-4.5553398.0537129-2.6096659-1.9597367-4.765177-4.4556604-4.7635351-2.440012-.0016419-4.4236212 2.0507567-4.4578592 4.5901485-.0351804 2.6076956 1.9616213 4.6748715 4.3554591 4.7287264zm8.7200274-11.1765419c.0003141-.7260566.0003141-1.4524415 0-2.178498 0-.5208167-.394209-.9352371-.8917603-.9355654-.6926141-.0003284-1.3852283-.0006568-2.0781565 0-.4962949.0006567-.8917603.4160622-.8920744.9368789-.0003141.7198172-.0021988 1.4396345.0025129 2.1597801.0006282.1073815.0201031.219032.0527706.320831.1243878.3832238.4601722.6183466.8713431.6203169.3342138.0006568.6684276-.0003284 1.0029555-.0003284.3618555-.0042689.7249675.0029555 1.0871372-.0062392.4658261-.0121502.8452719-.429526.8452719-.9171759zm0 0" fill-rule="evenodd"/></svg>';
							echo '</a>';
							echo '</li>';
						}
						if ( !empty( $series_custom_fields['youtube_url'] ) ) {
							echo '<li class="archive-meta__social-item">';
							echo '<a title="' . $series->name . ' on YouTube" href="' . $series_custom_fields['youtube_url'] . '" class="archive-meta__social-link">';
							echo '<svg role="img" height="36" viewBox="0 0 50 50" width="36" xmlns="http://www.w3.org/2000/svg"><path d="m50 25c0-13.8071194-11.1928806-25-25-25s-25 11.1928806-25 25 11.1928806 25 25 25 25-11.1928806 25-25zm-3 0c0-12.1502651-9.8497349-22-22-22s-22 9.8497349-22 22 9.8497349 22 22 22 22-9.8497349 22-22zm-10.231673 5.7654774c-.2984989 1.2972254-1.3596108 2.2537088-2.6364141 2.396384-3.0244348.3379444-6.0855174.339623-9.1334516.3379444-3.0476545.0016786-6.1090169 0-9.1331719-.3379444-1.277083-.1426752-2.3376355-1.0991586-2.6358546-2.396384-.4246686-1.8475042-.4246686-3.863421-.4246686-5.7651976 0-1.9020565.0050356-3.918253.4294244-5.7657572.2984989-1.2972254 1.3590513-2.2539886 2.6358546-2.396384 3.0244348-.3379444 6.0855175-.339623 9.1334517-.3379444 3.0476544-.0016786 6.1090168 0 9.1331718.3379444 1.2770831.1423954 2.338195 1.0991586 2.6364142 2.396384.4246685 1.8475042.4221507 3.8637007.4221507 5.7657572 0 1.9017766-.0025178 3.9176934-.4269066 5.7651976zm-13.9635608-10.2654774 6.75 3.8971143-6.75 3.8971143zm0 0" fill-rule="evenodd"/></svg>';
							echo '</a>';
							echo '</li>';
						}
						if ( !empty( $series_custom_fields['discord_url'] ) ) {
							echo '<li class="archive-meta__social-item">';
							echo '<a title="' . $series->name . ' on Discord" href="' . $series_custom_fields['discord_url'] . '" class="archive-meta__social-link">';
							echo '<svg role="img" width="36" height="36" viewBox="0 0 495 495" xmlns="http://www.w3.org/2000/svg"><g transform="matrix(.977258 0 0 .977258 -71.421272 -2.746468)"><path d="m422.644 166.337c-.076-.148-.2-.262-.353-.326-17.696-8.118-36.369-13.907-55.553-17.222-.357-.066-.718.104-.892.423-2.543 4.614-4.852 9.355-6.917 14.202-20.679-3.139-41.714-3.139-62.393 0-2.078-4.86-4.424-9.601-7.026-14.202-.181-.312-.535-.48-.892-.423-19.186 3.309-37.86 9.097-55.553 17.223-.152.064-.278.174-.365.315-35.382 52.838-45.074 104.375-40.32 155.276.026.253.155.482.356.638 20.602 15.255 43.645 26.897 68.148 34.434.353.107.736-.018.956-.313 5.265-7.16 9.927-14.743 13.942-22.67.235-.462.015-1.023-.472-1.201-7.353-2.813-14.473-6.204-21.289-10.143-.537-.316-.582-1.074-.086-1.452 1.431-1.072 2.862-2.186 4.227-3.311.248-.205.591-.25.883-.12 44.663 20.384 93.019 20.384 137.155 0 .293-.139.642-.097.894.109 1.366 1.126 2.796 2.25 4.238 3.322.498.373.459 1.132-.075 1.452-6.802 3.972-13.929 7.362-21.3 10.133-.486.184-.702.748-.464 1.211 4.083 7.883 8.739 15.456 13.93 22.657.217.303.602.434.958.326 24.546-7.511 47.631-19.156 68.259-34.434.203-.148.333-.377.355-.628 5.693-58.845-9.53-109.962-40.351-155.276zm-140.191 124.272c-13.447 0-24.527-12.339-24.527-27.494 0-15.156 10.864-27.497 24.527-27.497 13.769 0 24.742 12.448 24.528 27.495 0 15.157-10.866 27.496-24.528 27.496zm90.685 0c-13.447 0-24.527-12.339-24.527-27.494 0-15.156 10.866-27.497 24.527-27.497 13.77 0 24.743 12.448 24.528 27.495 0 15.157-10.758 27.496-24.528 27.496z"/><circle cx="326.343" cy="255.445" fill="none" r="236.238" stroke="currentColor" stroke-width="30"/></g></svg>';
							echo '</a>';
							echo '</li>';
						}
						echo '<li class="archive-meta__social-item">';
						echo '<a title="' . $series->name . ' RSS feed" class="archive-meta__social-link" href="/feed/podcast/' . $series->slug . '">';
						echo '<svg role="img" height="36" viewBox="0 0 50 50" width="36" xmlns="http://www.w3.org/2000/svg"><path d="m50 25c0-13.8071194-11.1928806-25-25-25s-25 11.1928806-25 25 11.1928806 25 25 25 25-11.1928806 25-25zm-3 0c0-12.1502651-9.8497349-22-22-22s-22 9.8497349-22 22 9.8497349 22 22 22 22-9.8497349 22-22zm-10.231673 5.7654774c-.2984989 1.2972254-1.3596108 2.2537088-2.6364141 2.396384-3.0244348.3379444-6.0855174.339623-9.1334516.3379444-3.0476545.0016786-6.1090169 0-9.1331719-.3379444-1.277083-.1426752-2.3376355-1.0991586-2.6358546-2.396384-.4246686-1.8475042-.4246686-3.863421-.4246686-5.7651976 0-1.9020565.0050356-3.918253.4294244-5.7657572.2984989-1.2972254 1.3590513-2.2539886 2.6358546-2.396384 3.0244348-.3379444 6.0855175-.339623 9.1334517-.3379444 3.0476544-.0016786 6.1090168 0 9.1331718.3379444 1.2770831.1423954 2.338195 1.0991586 2.6364142 2.396384.4246685 1.8475042.4221507 3.8637007.4221507 5.7657572 0 1.9017766-.0025178 3.9176934-.4269066 5.7651976zm-13.9635608-10.2654774 6.75 3.8971143-6.75 3.8971143zm0 0" fill-rule="evenodd"/></svg>';
						echo '</a>';
						echo '</li>';
						echo '</ul>';
						echo '</div>';
					}
				}
				the_archive_description( '<div class="archive-description">', '</div>' );
				?>
			</header><!-- .page-header -->

			<?php
			/* Start the Loop */
			while ( have_posts() ) :
				the_post();

				/*
				 * Include the Post-Type-specific template for the content.
				 * If you want to override this in a child theme, then include a file
				 * called content-___.php (where ___ is the Post Type name) and that will be used instead.
				 */
				get_template_part( 'template-parts/content', get_post_type() );

			endwhile;

			the_posts_navigation();

		else :

			get_template_part( 'template-parts/content', 'none' );

		endif;
		?>

	</main><!-- #main -->

<?php
get_sidebar();
get_footer();

/*
vim: tabstop=4 shiftwidth=4 noexpandtab nolist
*/
